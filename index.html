<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Ticker</title>
  <style>
    html, body {
      margin:0;
      padding:0;
      overflow:hidden; /* evita scroll interno */
    }
    #ticker-container {
      width:100%;
      height:40px;            /* altura fija */
      line-height:40px;       /* centra verticalmente */
      border-top:none;
      border-bottom:none;
      overflow:hidden;
      background:#0d1b2a;   /* azul petr√≥leo */
      color:#e0e1dd;        /* gris claro */
      font-family:"Open Sans", sans-serif;
      font-size:13px;
    }
    #ticker {
      display:inline-block;
      white-space:nowrap;
      animation:scroll-left 25s linear infinite;
    }
    .ticker-item {
      display:inline-block;
      margin:0 25px;
      font-weight:bold;
    }
    .ticker-up { color:#0f0; }
    .ticker-down { color:#f33; }
    .ticker-flat { color:#ff0; }

    @keyframes scroll-left {
      0%   { transform: translateX(0); }
      100% { transform: translateX(-50%); }
    }
  </style>
</head>
<body>
  <div id="ticker-container">
    <div id="ticker">Cargando datos del mercado...</div>
  </div>

  <script>
  async function loadTicker() {
    try {
      const res = await fetch("https://ticker.maurorojasbiz.workers.dev/");
      const data = await res.json();
      const tickerDiv = document.getElementById("ticker");
      tickerDiv.innerHTML = "";

      function addItem(label, obj) {
        const span = document.createElement("span");
        span.className = "ticker-item";
        if (obj && obj.usd != null) {
          const change = Number(obj.change);
          if (change > 0) span.classList.add("ticker-up");
          else if (change < 0) span.classList.add("ticker-down");
          else span.classList.add("ticker-flat");
          span.textContent = label + ": " + obj.usd.toFixed(2) + " (" + change + "%)";
        } else {
          span.classList.add("ticker-flat");
          span.textContent = label + ": ‚Äî";
        }
        tickerDiv.appendChild(span);
      }

      // Criptos
      addItem("‚Çø BTC", data.crypto?.BTC);
      addItem("Œû ETH", data.crypto?.ETH);
      addItem("‚óé SOL", data.crypto?.SOL);
      addItem("BNB", data.crypto?.BNB);
      addItem("RARI", data.crypto?.RARI);
      addItem("ZORA", data.crypto?.ZORA);

      // √çndices
      function addIndex(label, value) {
        const span = document.createElement("span");
        span.className = "ticker-item ticker-flat";
        span.textContent = label + ": " + (value ?? "‚Äî");
        tickerDiv.appendChild(span);
      }
      addIndex("S&P500", data.indices?.sp500);
      addIndex("Nasdaq", data.indices?.nasdaq);
      addIndex("DowJones", data.indices?.dowjones);

      // üîÅ duplicar contenido para scroll infinito
      tickerDiv.innerHTML += tickerDiv.innerHTML;

    } catch (err) {
      document.getElementById("ticker").textContent = "Error cargando datos";
      console.error("Ticker error:", err);
    }
  }

  loadTicker();
  setInterval(loadTicker, 300000); // refresca cada 5 min
  </script>
</body>
</html>
